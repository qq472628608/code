function sendAjax(e,t,n,u){var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4==o.readyState&&200==o.status?u&&u.call(this,o.responseText):4==o.readyState&&200!=o.status&&(window.location.href="404.html")},n?o.send(n):o.send()}var url=window.location.search,userId=url.substring(url.lastIndexOf("=")+1,url.length);console.log(userId),sendAjax("get","/currentUserId",null,function(){"unlogin"==arguments[0]?window.location.href="index.html":userId!=arguments[0]&&document.querySelector("input").setAttribute("disabled","disabled")}),sendAjax("get","/getInfo?id="+userId,null,function(){if(arguments[0]){var e=JSON.parse(arguments[0]);document.querySelector(".head_img").src=e.image,document.querySelector("input[name='name_input']").value=e.name,e.age?document.querySelector("input[name='age_input']").value=e.age:document.querySelector("input[name='age_input']").value="",e.school?document.querySelector("input[name='school_input']").value=e.school:document.querySelector("input[name='school_input']").value="",2==e.gender&&(document.querySelector("input[name='man']").removeAttribute("checked"),document.querySelector("input[name='woman']").setAttribute("checked","checked"))}});var file,img=document.querySelectorAll(".select_img img");for(var i in img)img[i].onclick=function(){var e=this.src;document.querySelector(".head_img").src=e};document.querySelector(".head_li a").onclick=function(){document.querySelector("input[name='head_input']").click(),document.querySelector("input[name='head_input']").onchange=function(){file=this.files[0];var e=new FileReader;e.readAsDataURL(file),e.onloadend=function(){document.querySelector(".head_img").src=this.result}}},document.querySelector(".btn_save").onclick=function(){var e=document.querySelector("input[name='name_input']").value,t=document.querySelector("input[name='age_input']").value,n=document.querySelector("input[name='school_input']").value,u=document.querySelector("input[checked='checked']").value,o=document.querySelector(".head_img").src,c=o.substring(o.lastIndexOf("/")+1,o.length),a="name="+e+"&age="+t+"&school="+n+"&gender="+u;if(file){var r=new FormData;r.append("file",file);var i=new XMLHttpRequest;i.open("post","/uploadMyFile",!0),i.send(r),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&sendAjax("post","/updateUserInfo",a,function(){alert("保存成功")})}}else a=a+"&image="+c,sendAjax("post","/updateUserInfo",a,function(){alert("保存成功")})},document.querySelector(".btn_cancel").onclick=function(){window.location.href="home.html"};