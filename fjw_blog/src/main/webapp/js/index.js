function sendAjax(e,t,n,r){var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4==o.readyState&&200==o.status?r&&r.call(this,o.responseText):4==o.readyState&&200!=o.status&&(window.location.href="404.html")},n?o.send(n):o.send()}function method_forget(){login.setAttribute("style","display:none;"),forget.setAttribute("style","display:block;")}function method_register(){login.setAttribute("style","display:none;"),register.setAttribute("style","display:block;")}function checkEmailFormat(e){return!!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(e)}function checkIdetify(e){var t=e.value;return!(t.length<6||t.length>12)||(e.parentNode.querySelector(".msg").innerHTML="密码必须为6~12位",!1)}function method_login(){login.setAttribute("style","display:block;"),register.setAttribute("style","display:none;"),forget.setAttribute("style","display:none;")}var login=document.querySelector("#login"),register=document.querySelector("#register"),forget=document.querySelector("#forget");document.querySelector(".logo").onclick=function(){window.location.href="index.html"},document.querySelector(".btn_login").onclick=function(){login.setAttribute("style","display:block;"),register.setAttribute("style","display:none;"),forget.setAttribute("style","display:none;"),sendAjax("get","/cookieContent",null,function(){if(arguments[0]){var e=JSON.parse(arguments[0]);login.querySelector("input[name='username']").value=e.username,login.querySelector("input[name='password']").value=e.password}})},document.querySelector(".btn_register").onclick=function(){register.setAttribute("style","display:block"),login.setAttribute("style","display:none;"),forget.setAttribute("style","display:none;")};var fa_times=document.querySelectorAll(".fa-times");for(var i in fa_times)fa_times[i].onclick=function(){this.parentNode.setAttribute("style","display:none;"),this.parentNode.querySelector("input").value="",this.parentElement.querySelector(".msg").innerHTML=""};document.querySelector("#login_fa1").onclick=function(){"fa fa-square-o"==this.className?this.className="fa fa-check-square-o":this.className="fa fa-square-o"},document.querySelector("#login .btn_submit").onclick=function(){var e=document.querySelector("#login .myInput[name='username']").value;if(checkEmailFormat(e)){var t=login.querySelector("input[name='password']").value,n="username="+e+"&password="+t;"fa fa-check-square-o"==document.querySelector("#login_fa1").className&&(n+="&remPassword=true"),sendAjax("post","/login",n,function(){arguments[0]?document.querySelector("#login .msg").innerHTML=arguments[0]:window.location.href="home.html"})}else document.querySelector("#login .msg").innerHTML="账号格式不正确"},register.querySelector(".btn_identify").onclick=function(){var e=this.parentNode.querySelector("input[name='password']"),t=this.parentNode.querySelector("input[name='username']").value,n=checkIdetify(e);n&&(sendAjax("post","/identifyCode","target="+t),alert("验证码已发送"))},forget.querySelector(".btn_identify").onclick=function(){var e=this.parentNode.querySelector("input[name='username']").value;sendAjax("post","/identifyCode","target="+e),alert("验证码已发送")};var usernameInput=document.querySelectorAll("input[name='username']");for(var i in usernameInput)usernameInput[i].onchange=function(){this.parentNode.querySelector(".msg").innerHTML=""};var passwordInput=document.querySelectorAll("input[name='password']");for(var i in passwordInput)passwordInput[i].onchange=function(){var e=this.parentNode.querySelector("input[name='username']").value,t=this.parentNode.querySelector(".msg");checkEmailFormat(e)?"密码必须为6~12位"==t.innerHTML&&(t.innerHTML=""):t.innerHTML="账号格式不正确"};var password2Input=document.querySelectorAll("input[name='password2']");for(var i in password2Input)password2Input[i].onchange=function(){var e=this.parentNode.querySelector(".msg");"密码不一致"==e.innerHTML&&(e.innerHTML="")};var identifyInput=document.querySelectorAll(".indentify_input");for(var i in identifyInput)identifyInput[i].onchange=function(){var e=this.parentNode.querySelector(".msg");"验证码错误"==e.innerHTML&&(e.innerHTML="")};document.querySelector("#register .btn_submit").onclick=function(){var e=this.parentNode.querySelector("input[name='password']").value,t=this.parentNode.querySelector(".msg");(e.length<6||e.length>12)&&(this.parentNode.querySelector(".msg").innerHTML="密码必须为6~12位");var n=this.parentNode.querySelector("input[name='password2']").value;e!=n&&(t.innerHTML="密码不一致");var r=this.parentNode.querySelector(".identify_input").value,o=this.parentNode.querySelector("input[name='username']").value;if(""==t.innerHTML){var i="username="+o+"&password="+e+"&identifyCode="+r;sendAjax("post","/regist",i,function(){arguments[0]?t.innerHTML=arguments[0]:window.location.href="home.html"})}},document.querySelector("#forget .btn_submit").onclick=function(){var e=this.parentNode.querySelector("input[name='password']").value,t=this.parentNode.querySelector("input[name='password2']").value,n=this.parentNode.querySelector(".msg");e!=t&&(n.innerHTML="密码不一致");var r=this.parentNode.querySelector(".identify_input").value,o=this.parentNode.querySelector("input[name='username']").value;if(""==n.innerHTML){var i="username="+o+"&password="+e+"&identifyCode="+r;sendAjax("post","/forgetPassword",i,function(){arguments[0]?n.innerHTML=arguments[0]:window.location.href="home.html"})}};